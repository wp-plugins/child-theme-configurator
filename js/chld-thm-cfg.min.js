jQuery(document).ready(function(e){function t(e){return h(e)?e:e.toString().replace(X,"&quot;")}function c(e){var t=parseInt(e),c=String.fromCharCode(t);return c}function a(e){var t=e.charCodeAt(0);return t}function n(t,c){var a=!1;return e.each(ctcAjax.themes,function(n,l){return e.each(l,function(e){return e!=t||"parnt"!=n&&"new"!=c?void 0:(a=!0,!1)}),a?!1:void 0}),a}function l(){var t=/[^\w\-]/,c=e("#ctc_child_template").length?e("#ctc_child_template").val().toString().replace(t).toLowerCase():"",a=e("#ctc_theme_child").length?e("#ctc_theme_child").val().toString().replace(t).toLowerCase():c,l=e("input[name=ctc_child_type]:checked").val(),r=[];return"new"==l&&(a=c),n(a,l)&&r.push(ctcAjax.theme_exists_txt.toString().replace(/%s/,a)),""===a&&r.push(ctcAjax.inval_theme_txt),""===e("#ctc_child_name").val()&&r.push(ctcAjax.inval_name_txt),r.length?(F({error:r}),!1):!0}function r(){if(e("#ctc_theme_parnt").length){for(var t=e("#ctc_theme_parnt").val(),c=slugbase=t+"-child",a=ctcAjax.themes.parnt[t].Name+" Child",l="",r="",i="00";n(c,"new");)l=""==l?2:l+1,r=i.substring(0,i.length-l.toString().length)+l.toString(),c=slugbase+r;Y=c,Z=a+(r.length?" "+r:"")}}function i(t){var c=t+"_panel";e(".nav-tab").removeClass("nav-tab-active"),e(".ctc-option-panel").removeClass("ctc-option-panel-active"),e(".ctc-selector-container").hide(),e(t).addClass("nav-tab-active"),e(".ctc-option-panel-container").scrollTop(0),e(c).addClass("ctc-option-panel-active")}function s(c){var a;e("#ctc_rewrite_selector").length?(a=e("#ctc_rewrite_selector_orig").val(),e("#ctc_sel_ovrd_selector_selected").text(a),e(c).text(ctcAjax.rename_txt)):(a=e("#ctc_sel_ovrd_selector_selected").text(),e("#ctc_sel_ovrd_selector_selected").html('<textarea id="ctc_rewrite_selector" name="ctc_rewrite_selector" autocomplete="off"></textarea><input id="ctc_rewrite_selector_orig" name="ctc_rewrite_selector_orig" type="hidden" value="'+t(a)+'"/>'),e("#ctc_rewrite_selector").val(a),e(c).text(ctcAjax.cancel_txt))}function o(){e(".updated, .error").slideUp("slow",function(){e(".updated").remove()})}function _(t){var c=/^(ctc_(ovrd|\d+)_(parent|child)_([0-9a-z\-]+)_(\d+))(_\w+)?$/,a=e(t).parents(".ctc-selector-row, .ctc-parent-row").first(),n=a.find(".ctc-swatch").first(),l={parent:{},child:{}},r={parent:{origin:"",start:"",end:""},child:{origin:"",start:"",end:""}},i={child:!1,parent:!1},s={};return a.find(".ctc-parent-value, .ctc-child-value").each(function(){var a,n,o=e(this).attr("id"),_=o.toString().match(c),u=_[2],p=_[3],v="undefined"==typeof _[4]?"":_[4],f=_[5],m="undefined"==typeof _[6]?"":_[6],x="parent"==p?e(this).text().replace(/!$/,""):e(this).val(),g="ctc_"+u+"_child_"+v+"_i_"+f;if(!1===h(e(this).data("color"))&&(x=e(this).data("color"),e(this).data("color",null)),"child"==p&&(s[o]=x,s[g]=e("#"+g).is(":checked")?1:0),""!=x)if(!1===h(m))switch(m){case"_border_width":l[p][v+"-width"]="none"==x?0:x;break;case"_border_style":l[p][v+"-style"]=x;break;case"_border_color":l[p][v+"-color"]=x;break;case"_background_url":l[p]["background-image"]=d(p,x);break;case"_background_color":l[p]["background-color"]=t.value;break;case"_background_color1":r[p].start=x,i[p]=!0;break;case"_background_color2":r[p].end=x,i[p]=!0;break;case"_background_origin":r[p].origin=x,i[p]=!0}else(a=v.toString().match(/^border(\-(top|right|bottom|left))?$/)&&!x.match(/none/))?(n=x.toString().split(/ +/),l[p][v+"-width"]="undefined"==typeof n[0]?"":n[0],l[p][v+"-style"]="undefined"==typeof n[1]?"":n[1],l[p][v+"-color"]="undefined"==typeof n[2]?"":n[2]):"background-image"!=v||x.match(/none/)?"seq"!=v&&(l[p][v]=x):x.toString().match(/url\(/)?l[p]["background-image"]=d(p,x):(n=x.toString().split(/ +/),n.length>2?(r[p].origin="undefined"==typeof n[0]?"top":n[0],r[p].start="undefined"==typeof n[1]?"transparent":n[1],r[p].end="undefined"==typeof n[2]?"transparent":n[2],i[p]=!0):l[p]["background-image"]=x)}),"undefined"!=typeof n&&!1===h(n.attr("id"))&&(n.removeAttr("style"),i.parent&&n.ctcgrad(r.parent.origin,[r.parent.start,r.parent.end]),n.css(l.parent),n.attr("id").toString().match(/parent/)||(i.child&&n.ctcgrad(r.child.origin,[r.child.start,r.child.end]),n.css(l.child)),n.css({"z-index":-1})),s}function u(e,t){t="undefined"==typeof t?"":t;var c={orig:t};if(e.toString().match(/^border(\-(top|right|bottom|left))?$/)){var a=t.toString().split(/ +/);c.names=["_border_width","_border_style","_border_color"],c.values=["undefined"==typeof a[0]?"":a[0],"undefined"==typeof a[1]?"":a[1],"undefined"==typeof a[2]?"":a[2]]}else if(e.toString().match(/^background\-image/))if(c.names=["_background_url","_background_origin","_background_color1","_background_color2"],c.values=["","","",""],!1!==h(t)||t.toString().match(/(url|none)/))c.values[0]=t;else{var a=t.toString().split(/:/);c.values[1]="undefined"==typeof a[0]?"":a[0],c.values[2]="undefined"==typeof a[1]?"":a[1],c.values[3]="undefined"==typeof a[3]?"":a[3],c.orig=[c.values[1],c.values[2],c.values[3]].join(" ")}else c.names=[""],c.values=[t];return c}function d(e,t){var c,a=t.toString().match(/url\(['" ]*(.+?)['" ]*\)/),n=h(a)?null:a[1],l=ctcAjax.theme_uri+"/"+("parent"==e?ctcAjax.parnt:ctcAjax.child)+"/";return n?c=n.toString().match(/^(data:|https?:|\/)/)?t:"url("+l+n+")":!1}function h(e){if("undefined"==typeof e||!1===e||null===e||""===e)return!0;if(!0===e||"string"==typeof e||"number"==typeof e)return!1;if("object"==typeof e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}return!1}function p(e){if("object"==typeof ctcAjax.sel_val[e]&&"object"==typeof ctcAjax.sel_val[e].value)for(var t in ctcAjax.sel_val[e].value)if(ctcAjax.sel_val[e].value.hasOwnProperty(t)&&(!1===h(ctcAjax.sel_val[e].value[t].child)||!1===h(ctcAjax.sel_val[e].value[t].parnt)))return e;return delete ctcAjax.sel_val[e],!1}function v(){tt.rld_rule=1,tt.rld_sel=1,f(),x()}function f(){if(1!==tt.sel_ndx){if(0===tt.sel_ndx||1==tt.rld_sel)return tt.sel_ndx=1,tt.rld_sel=0,void L("sel_ndx",null,f);at=[],!1===h(ctcAjax.sel_ndx)&&e.each(ctcAjax.sel_ndx,function(e){var t={label:e,value:e};at.push(t)}),C(),m()}}function m(){if(1!==tt.sel_ndx){if(0===tt.sel_ndx)return tt.sel_ndx=1,void L("sel_ndx",et,m);ct=[],!1===h(ctcAjax.sel_ndx)&&e.each(ctcAjax.sel_ndx[et],function(e,t){var c={label:e,value:t};ct.push(c)}),M(),tt.set_sel&&(tt.set_sel=0,$(K,null))}}function x(){if(1!==tt.rule){if(0===tt.rule||1==tt.rld_rule)return tt.rule=1,tt.rld_rule=0,void L("rule",null,x);nt=[],!1===h(ctcAjax.rule)&&e.each(ctcAjax.rule,function(e,t){var a={label:t.replace(/\d+/g,c),value:e};nt.push(a)}),nt=nt.sort(function(e,t){return e.label>t.label?1:e.label<t.label?-1:0}),T(),D()}}function g(e){return 1===tt.sel_val?!1:h(ctcAjax.sel_val[e])?(0==tt.sel_val&&(tt.sel_val=1,L("sel_val",e,g)),!1):(K=e,void(1==tt.set_qry?(tt.set_qry=0,P(ctcAjax.sel_val[e].query)):1==tt.new_sel&&(tt.new_sel=0,b(e))))}function y(t,a){var n=[],l=h(ctcAjax.sel_val[K])||h(ctcAjax.sel_val[K].value);h(nt)&&x(),e.each(nt,function(a,r){var i=!1,s=new RegExp(e.ui.autocomplete.escapeRegex(t.term),"i");if(s.test(r.label)){if(!1===l&&(e.each(ctcAjax.sel_val[K].value,function(e){return r.label==e.replace(/\d+/g,c)?(i=!0,!1):void 0}),i))return;n.push(r)}}),a(n)}function j(a,n,l){var r="",i=h(ctcAjax.sel_val[a])||h(ctcAjax.sel_val[a].value)||h(ctcAjax.sel_val[a].value[n])?"":ctcAjax.sel_val[a].value[n],s=u(n,"undefined"==typeof i?"":i.parnt),o=!1===h(i.i_parnt)&&1==i.i_parnt?ctcAjax.important_label:"",_=u(n,"undefined"==typeof i?"":i.child),d=!1===h(i.i_child)&&1==i.i_child?1:0,p="ctc_"+l+"_child_"+n+"_i_"+a;return!1===h(ctcAjax.sel_val[a])&&(r+='<div class="ctc-'+("ovrd"==l?"input":"selector")+'-row clearfix">'+W,r+='<div class="ctc-input-cell">'+("ovrd"==l?n.replace(/\d+/g,c):ctcAjax.sel_val[a].selector+'<br/><a href="#" class="ctc-selector-edit" id="ctc_selector_edit_'+a+'" >'+ctcAjax.edit_txt+"</a> "+(h(s.orig)?ctcAjax.child_only_txt:""))+"</div>"+W,"ovrd"==l&&(r+='<div class="ctc-parent-value ctc-input-cell" id="ctc_'+l+"_parent_"+n+"_"+a+'">'+(h(s.orig)?"[no value]":s.orig+o)+"</div>"+W),r+='<div class="ctc-input-cell">'+W,!1===h(s.names)&&(e.each(s.names,function(e,c){c=h(c)?"":c,r+='<div class="ctc-child-input-cell">'+W;var i,s="ctc_"+l+"_child_"+n+"_"+a+c;!1===(i=_.values.shift())&&(i=""),r+=(h(c)?"":ctcAjax.field_labels[c]+":<br/>")+'<input type="text" id="'+s+'" name="'+s+'" class="ctc-child-value'+((c+n).toString().match(/color/)?" color-picker":"")+(c.toString().match(/url/)?" ctc-input-wide":"")+'" value="'+t(i)+'" />'+W,r+="</div>"+W}),r+='<label for="'+p+'"><input type="checkbox" id="'+p+'" name="'+p+'" value="1" '+(1===d?"checked":"")+" />"+ctcAjax.important_label+"</label>"+W),r+="</div>"+W,r+="ovrd"==l?"":'<div class="ctc-swatch ctc-specific" id="ctc_child_'+n+"_"+a+'_swatch">'+ctcAjax.swatch_txt+"</div>"+W+'<div class="ctc-child-input-cell ctc-button-cell" id="ctc_save_'+n+"_"+a+'_cell">'+W+'<input type="button" class="button ctc-save-input" id="ctc_save_'+n+"_"+a+'" name="ctc_save_'+n+"_"+a+'" value="Save" /></div>'+W,r+="</div><!-- end input row -->"+W),r}function b(t){var c,a,n;(t=p(t))?(e("#ctc_sel_ovrd_qsid").val(t),K=t,h(ctcAjax.sel_val[t].seq)?e("#ctc_child_load_order_container").html(""):(c="ctc_ovrd_child_seq_"+t,n=parseInt(ctcAjax.sel_val[t].seq),a='<input type="text" id="'+c+'" name="'+c+'" class="ctc-child-value" value="'+n+'" />',e("#ctc_child_load_order_container").html(a)),h(ctcAjax.sel_val[t].value)?e("#ctc_sel_ovrd_rule_inputs").slideUp(function(){e("#ctc_sel_ovrd_rule_inputs").html("")}):(a="",e.each(ctcAjax.sel_val[t].value,function(e){a+=j(t,e,"ovrd")}),e("#ctc_sel_ovrd_rule_inputs").html(a).find(".color-picker").each(function(){S(this)}),_("#ctc_child_all_0_swatch"),lt.length?G():(e("#ctc_sel_ovrd_selector_selected").text(ctcAjax.sel_val[t].selector),e(".ctc-rewrite-toggle").text(ctcAjax.rename_txt),e("#ctc_sel_ovrd_new_rule, #ctc_sel_ovrd_rule_header, #ctc_sel_ovrd_rule_inputs_container, #ctc_sel_ovrd_rule_inputs, .ctc-rewrite-toggle").slideDown()))):(e("#ctc_sel_ovrd_selector_selected").html("&nbsp;"),e("#ctc_sel_ovrd_new_rule, #ctc_sel_ovrd_rule_header, #ctc_sel_ovrd_rule_inputs_container, #ctc_sel_ovrd_rule_inputs, .ctc-rewrite-toggle").slideUp(function(){e("#ctc_sel_ovrd_rule_inputs").html("")})),a=null}function w(t){if(1===tt.preview)return!1;if(0==tt.preview){tt.preview=1;var t;return(t=t.match(/(child|parnt)/)[1])||(t="child"),L("preview",t,w),!1}e("#view_"+t+"_options_panel").text(ctcAjax.previewResponse),ctcAjax.previewResponse=null,tt.preview=0}function A(t){if(1===tt.rule_val)return!1;if(0==tt.rule_val)return tt.rule_val=1,L("rule_val",t,A),!1;var c=ctcAjax.rule[t],a='<div class="ctc-input-row clearfix" id="ctc_rule_row_'+c+'">'+W;!1===h(ctcAjax.rule_val[t])&&(e.each(ctcAjax.rule_val[t],function(e,t){var n=u(c,t);a+='<div class="ctc-parent-row clearfix" id="ctc_rule_row_'+c+"_"+e+'">'+W,a+='<div class="ctc-input-cell ctc-parent-value" id="ctc_'+e+"_parent_"+c+"_"+e+'">'+n.orig+"</div>"+W,a+='<div class="ctc-input-cell">'+W,a+='<div class="ctc-swatch ctc-specific" id="ctc_'+e+"_parent_"+c+"_"+e+'_swatch">'+ctcAjax.swatch_txt+"</div></div>"+W,a+='<div class="ctc-input-cell"><a href="#" class="ctc-selector-handle" id="ctc_selector_'+c+"_"+e+'">'+ctcAjax.selector_txt+"</a></div>"+W,a+='<div id="ctc_selector_'+c+"_"+e+'_container" class="ctc-selector-container">'+W,a+='<a href="#" id="ctc_selector_'+c+"_"+e+'_close" class="ctc-selector-handle ctc-exit" title="'+ctcAjax.close_txt+'"></a>',a+='<div id="ctc_selector_'+c+"_"+e+'_inner_container" class="ctc-selector-inner-container clearfix">'+W,a+='<div id="ctc_status_val_qry_'+e+'"></div>'+W,a+='<div id="ctc_selector_'+c+"_"+e+'_rows"></div>'+W,a+="</div></div></div>"+W}),a+="</div>"+W),e("#ctc_rule_value_inputs").html(a).find(".ctc-swatch").each(function(){_(this)}),a=null}function k(){var t="";if(h(ctcAjax.recent)&&!1===h(ctcAjax.recent_txt))t+=ctcAjax.recent_txt;else{if(h(ctcAjax.recent))return;t+="<ul>\n",e.each(ctcAjax.recent,function(c,a){e.each(a,function(e,c){t+='<li><a href="#" class="ctc-selector-edit" id="ctc_selector_edit_'+e+'" >'+c+"</a></li>\n"})}),t+="</ul>\n"}e("#ctc_recent_selectors").html(t),t=null}function q(t){if(1==tt.val_qry)return!1;var c,n,l=e("#ctc_rule_menu_selected").text().replace(/[^\w\-]/g,a),r="";return 0===tt.val_qry?(tt.val_qry=1,c={rule:l},L("val_qry",t,q,c),!1):(!1===h(ctcAjax.val_qry[t])&&e.each(ctcAjax.val_qry[t],function(c,a){page_rule=c,e.each(a,function(a,n){r+='<h4 class="ctc-query-heading">'+a+"</h4>"+W,!1===h(n)&&e.each(n,function(e,a){ctcAjax.sel_val[e]=a,r+=j(e,c,t)})})}),n="#ctc_selector_"+l+"_"+t+"_rows",e(n).html(r).find(".color-picker").each(function(){S(this)}),e(n).find(".ctc-swatch").each(function(){_(this)}),void(lt.length&&G()))}function S(t){try{e(t).iris({change:function(c,a){e(t).data("color",a.color.toString()),_(t)}})}catch(c){B(c,"Iris Color Picker")}}function C(){try{e("#ctc_sel_ovrd_query").autocomplete({source:at,minLength:0,selectFirst:!0,autoFocus:!0,select:function(e,t){return P(t.item.value),!1},focus:function(e){e.preventDefault()}})}catch(t){B(t,"Query Menu")}}function M(){try{e("#ctc_sel_ovrd_selector").autocomplete({source:ct,selectFirst:!0,autoFocus:!0,select:function(e,t){return $(t.item.value,t.item.label),!1},focus:function(e){e.preventDefault()}})}catch(t){B(t,"Selector Menu")}}function T(){try{e("#ctc_rule_menu").autocomplete({source:nt,selectFirst:!0,autoFocus:!0,select:function(e,t){return U(t.item.value,t.item.label),!1},focus:function(e){e.preventDefault()}})}catch(t){B(t,"Rule Menu")}}function D(){try{e("#ctc_new_rule_menu").autocomplete({source:y,selectFirst:!0,autoFocus:!0,select:function(t,c){t.preventDefault();var n=e(j(K,c.item.label.replace(/[^\w\-]/g,a),"ovrd"));return e("#ctc_sel_ovrd_rule_inputs").append(n),e("#ctc_new_rule_menu").val(""),h(ctcAjax.sel_val[K].value)&&(ctcAjax.sel_val[K].value={}),ctcAjax.sel_val[K].value[c.item.label]={child:""},n.find('input[type="text"]').each(function(t,c){e(c).hasClass("color-picker")&&S(c),e(c).focus()}),lt.length&&G(),!1},focus:function(e){e.preventDefault()}})}catch(t){B(t,"New Rule Menu")}}function R(){if(e("#ctc_theme_child").length&&e("#ctc_child_type_existing").is(":checked")){var t=e("#ctc_theme_child").val();!1===h(t)&&(e("#ctc_child_name").val(ctcAjax.themes.child[t].Name),e("#ctc_child_author").val(ctcAjax.themes.child[t].Author),e("#ctc_child_version").val(ctcAjax.themes.child[t].Version))}}function F(t){var c="";!1===h(t)&&e.each(t,function(t,a){c+='<div class="'+t+'"><ul>'+W,e(a).each(function(e,t){c+="<li>"+t.toString()+"</li>"+W}),c+="</ul></div>"}),e("#ctc_error_notice").html(c),e("html, body").animate({scrollTop:0},"slow")}function N(t){e("#ctc_theme_parent").parents(".ctc-input-row").first().append('<span class="ctc-status-icon spinner"></span>'),e(".spinner").show(),document.location="?page="+ctcAjax.page+"&ctc_parent="+t.value}function I(t){!1===h(ctcAjax.themes.child[t.value])&&(e("#ctc_child_name").val(ctcAjax.themes.child[t.value].Name),e("#ctc_child_author").val(ctcAjax.themes.child[t.value].Author),e("#ctc_child_version").val(ctcAjax.themes.child[t.value].Version))}function P(t){et=t,e("#ctc_sel_ovrd_query").val(""),e("#ctc_sel_ovrd_query_selected").text(t),e("#ctc_sel_ovrd_selector").val(""),e("#ctc_sel_ovrd_selector_selected").html("&nbsp;"),e("#ctc_sel_ovrd_rule_inputs").html(""),m()}function $(t){e("#ctc_sel_ovrd_selector").val(""),1!=tt.sel_val&&(tt.sel_val=0),K=t,tt.new_sel=1,g(t)}function U(t,c){e("#ctc_rule_menu").val(""),e("#ctc_rule_menu_selected").text(c),1!=tt.rule_val&&(tt.rule_val=0),A(t),e(".ctc-rewrite-toggle").text(ctcAjax.rename_txt),e("#ctc_rule_value_inputs, #ctc_input_row_rule_header").show()}function z(t){var c=e(t).attr("id").match(/_(\d+)$/)[1];i("#query_selector_options"),tt.sel_val=0,tt.set_sel=tt.set_qry=1,K=c,g(c)}function E(){var t,c=e("#ctc_theme_parnt").val(),a=ctcAjax.theme_uri.replace(/^https?:\/\//,""),n=ctcAjax.homeurl.replace(/^https?/,ctcAjax.ssl?"https":"http"),l=n+"?preview=1&p=x&template="+c+"&stylesheet="+c,r=new RegExp("<link rel=[\"']stylesheet[\"'][^>]+?"+a+"/"+c+"/(.+?\\.css)[^>]+?>","g");h(c)||(c!=ctcAjax.parnt?e.get(l,function(c){for(;(t=r.exec(c))&&"style.css"!=t[1];)t[1].match(/bootstrap/)||e(".ctc_checkbox").each(function(){e(this).val()==t[1]&&e(this).prop("checked",!0)});c=null}):e(ctcAjax.addl_css).each(function(t,c){e("#ctc_stylesheet_files .ctc_checkbox").each(function(){e(this).val()==c&&e(this).prop("checked",!0)})}))}function L(t,c,a,n){var l={ctc_query_obj:t,ctc_query_key:c},r="#ctc_status_"+t+("val_qry"==t?"_"+c:"");return"object"==typeof n&&e.each(n,function(e,t){l["ctc_query_"+e]=t}),e(".query-icon").remove(),e(r).append('<span class="ctc-status-icon spinner query-icon"></span>'),e(".spinner").show(),l.action=!1===h(e("#ctc_action").val())&&"plugin"==e("#ctc_action").val()?"ctc_plgqry":"ctc_query",l._wpnonce=e("#_wpnonce").val(),e.post(ctcAjax.ajaxurl,l,function(n){tt[t]=2,h(n)?(e(".query-icon").addClass("failure"),"preview"==t&&(ctcAjax.previewResponse=ctcAjax.css_fail_txt,a(c))):(e(".ctc-status-icon").addClass("success"),1==tt.refresh&&(tt.refresh=0,V()),Q(n),n=null,k(),"function"==typeof a&&a(c))},"json").fail(function(){e(".query-icon").removeClass("spinner"),e(".query-icon").addClass("failure"),"preview"==t?(ctcAjax.previewResponse=ctcAjax.css_fail_txt,tt[t]=2,a(c)):tt[t]=0}),!1}function O(t,c){var a,n,l,r,i={},s=e(t).attr("id");return e(t).prop("disabled",!0),e(".save-icon").remove(),e(t).parent(".ctc-textarea-button-cell, .ctc-button-cell").append('<span class="ctc-status-icon spinner save-icon"></span>'),s.match(/ctc_configtype/)?(e(t).parents(".ctc-input-row").first().append('<span class="ctc-status-icon spinner save-icon"></span>'),i.ctc_configtype=e(t).val()):(a=e("#ctc_new_selectors"))&&"ctc_save_new_selectors"==e(t).attr("id")?(i.ctc_new_selectors=a.val(),(n=e("#ctc_sel_ovrd_query_selected"))&&(i.ctc_sel_ovrd_query=n.text())):(l=e("#ctc_child_imports"))&&"ctc_save_imports"==e(t).attr("id")?i.ctc_child_imports=l.val():"ctc_is_debug"==e(t).attr("id")?i.ctc_is_debug=e("#ctc_is_debug").is(":checked")?1:0:i=_(t),e(".save-icon").show(),e("#ctc_sel_ovrd_selector_selected").find("#ctc_rewrite_selector").each(function(){r=e("#ctc_rewrite_selector").val(),origsel=e("#ctc_rewrite_selector_orig").val(),h(r)||!r.toString().match(/\w/)?r=origsel:i.ctc_rewrite_selector=r,e(".ctc-rewrite-toggle").text(ctcAjax.rename_txt),e("#ctc_sel_ovrd_selector_selected").html(r)}),i.action=!1===h(e("#ctc_action").val())&&"plugin"==e("#ctc_action").val()?"ctc_plugin":"ctc_update",i._wpnonce=e("#_wpnonce").val(),e.post(ctcAjax.ajaxurl,i,function(a){return e(t).prop("disabled",!1),e(".save-icon").removeClass("spinner"),h(a)?e(".save-icon").addClass("failure"):(e("#ctc_new_selectors").val(""),1==tt.refresh&&(tt.refresh=0,V()),Q(a),a=null,h(H)?K&&(b(K),k()):($(H,J),H=J=null),e(".save-icon").addClass("success"),"function"==typeof c&&c()),!1},"json").fail(function(){e(t).prop("disabled",!1),e(".save-icon").removeClass("spinner"),e(".save-icon").addClass("failure")}),!1}function Q(t){e(t).each(function(){switch(this.obj){case"imports":ctcAjax.imports=this.data;break;case"rule_val":ctcAjax.rule_val[this.key]=this.data;break;case"val_qry":ctcAjax.val_qry[this.key]=this.data;break;case"rule":ctcAjax.rule=this.data;break;case"sel_ndx":h(this.key)?ctcAjax.sel_ndx=this.data:"qsid"==this.key?(h(ctcAjax.sel_ndx[this.data.query])&&(ctcAjax.sel_ndx[this.data.query]={}),ctcAjax.sel_ndx[this.data.query][this.data.selector]=this.data.qsid):(ctcAjax.sel_ndx[this.key]=this.data,et=this.key);break;case"sel_val":ctcAjax.sel_val[this.key]=this.data,K=this.key;break;case"rewrite":K=this.key,H=this.key,J=this.data;break;case"recent":ctcAjax.recent=this.data;break;case"stylesheets":e("#ctc_stylesheet_files").html(this.data);break;case"backups":e("#ctc_backup_files").html(this.data);break;case"addl_css":ctcAjax.addl_css=this.data;break;case"debug":e("#ctc_debug_container").html(this.data);break;case"preview":case"all_styles":ctcAjax.previewResponse=this.data}}),t=null}function V(){et="base",K=null,ct=[],at=[],nt=[],tt.rld_rule=1,tt.rld_sel=1,tt.set_qry=1,ctcAjax.imports=[],ctcAjax.recent={},ctcAjax.rule={},ctcAjax.sel_ndx={},ctcAjax.val_qry={},ctcAjax.rule_val={},ctcAjax.sel_val={},v()}function B(e,t){var c=h(e.lineNumber)?"":" line: "+e.lineNumber,a=h(e.fileName)?"":" "+e.fileName.split(/\?/)[0];lt.push("<code><small>"+t+": "+e.message+a+c+"</small></code>")}function G(){var t=[],c=[];e("input[type=submit], input[type=button]").prop("disabled",!0),e("script").each(function(){var c=e(this).prop("src");!1===h(c)&&c.match(/jquery(\.min|\.js|\-?ui)/i)&&!c.match(/load\-scripts.php/)&&t.push("<code><small>"+c.split(/\?/)[0]+"</small></code>")}),c.push("<strong>"+ctcAjax.js_txt+"</strong>"),1==ctcAjax.is_debug&&c.push(lt.join("<br/>")),t.length&&c.push(ctcAjax.jquery_txt+"<br/>"+t.join("<br/>")),c.push(ctcAjax.plugin_txt+" "+ctcAjax.contact_txt),F({error:c})}var H,J,K,W="\n",X=new RegExp('"',"g"),Y="",Z="",et="base",tt={rule:0,sel_ndx:0,val_qry:0,rule_val:0,sel_val:0,preview:0,recent:0,rld_rule:0,rld_sel:0,set_qry:0,set_sel:0,new_sel:0,refresh:0},ct=[],at=[],nt=[],lt=[];if(r(),R(),!e("#ctc_theme_parnt").is("input")){try{e.widget("ctc.themeMenu",e.ui.selectmenu,{_renderItem:function(t,c){var a=e("<li>");return e("#ctc_theme_option_"+c.value).detach().appendTo(a),a.appendTo(t)}})}catch(rt){B(rt,"Theme Menu")}try{e("#ctc_theme_parnt").themeMenu({select:function(e,t){N(t.item)}})}catch(rt){"function"==typeof themeMenu?e("#ctc_theme_parnt").themeMenu("destroy"):e("#ctc_theme_parnt-button").remove(),B(rt,"Parent Theme Menu")}if(h(ctcAjax.themes.child))e("#ctc_child_name").length&&(e("#ctc_child_name").val(Z),e("#ctc_child_template").val(Y));else try{e("#ctc_theme_child").themeMenu({select:function(e,t){I(t.item)}})}catch(rt){"function"==typeof themeMenu?e("#ctc_theme_child").themeMenu("destroy"):e("#ctc_theme_child-button").remove(),B(rt,"Child Theme Menu")}}e(".nav-tab").on("click",function(t){t.preventDefault(),e(".ctc-status-icon").remove();var c="#"+e(this).attr("id");i(c)}),h(lt)?(e("#ctc_main").on("focus",".color-picker",function(){try{e(".color-picker").not(this).iris("hide"),e(this).iris("toggle"),e(".iris-picker").css({position:"absolute","z-index":10})}catch(t){B(t,"Iris Color Picker")}}),e("#ctc_main").on("change",".ctc-child-value, input[type=checkbox]",function(){_(this)}),e("#ctc_main").on("click",".ctc-selector-handle",function(t){t.preventDefault();var c=e(this).attr("id").toString().replace("_close",""),a=c.toString().match(/_(\d+)$/)[1];e("#"+c+"_container").is(":hidden")&&(1!=tt.val_qry&&(tt.val_qry=0),q(a)),e("#"+c+"_container").fadeToggle("fast"),e(".ctc-selector-container").not("#"+c+"_container").fadeOut("fast")}),e("#ctc_main").on("click",".ctc-save-input",function(){O(this,v)}),e("#ctc_main").on("click",".ctc-selector-edit",function(){z(this)}),e("#ctc_main").on("click",".ctc-rewrite-toggle",function(e){e.preventDefault(),s(this)}),e("#ctc_main").on("click",".ctc-section-toggle",function(){e(this).toggleClass("open");var t=e(this).attr("id")+"_content";e("#"+t).slideToggle("fast")}),e("#ctc_main").on("click","#ctc_copy_selector",function(){var t=e("#ctc_sel_ovrd_selector_selected").text().trim();!1===h(t)&&e("#ctc_new_selectors").val(e("#ctc_new_selectors").val()+"\n"+t+" {\n\n}")}),e("#ctc_configtype").on("change",function(){var t=e(this).val();if(h(t)||"theme"==t){e(".ctc-theme-only, .ctc-themeonly-container").removeClass("ctc-disabled"),e(".ctc-theme-only, .ctc-themeonly-container input").prop("disabled",!1);try{e("#ctc_theme_parnt, #ctc_theme_child").themeMenu("enable")}catch(c){B(c,"Theme Menu")}}else{e(".ctc-theme-only, .ctc-themeonly-container").addClass("ctc-disabled"),e(".ctc-theme-only, .ctc-themeonly-container input").prop("disabled",!0);try{e("#ctc_theme_parnt, #ctc_theme_child").themeMenu("disable")}catch(c){B(c,"Theme Menu")}}}),e("#view_child_options, #view_parnt_options").on("click",function(){w(e(this).attr("id"))}),e("#ctc_load_form").on("submit",function(){return l()}),e("#ctc_theme_child, #ctc_theme_child-button, #ctc_child_type_existing").on("focus click",function(){e("#ctc_child_type_existing").prop("checked",!0),e("#ctc_child_type_new").prop("checked",!1),e("#ctc_child_template").val(""),R()}),e("#ctc_child_type_new, #ctc_child_template").on("focus click",function(){e("#ctc_child_type_existing").prop("checked",!1),e("#ctc_child_type_new").prop("checked",!0),e("#ctc_child_name").val(Z),e("#ctc_child_template").val(Y)}),e("#recent_edits").on("click",function(t){return t.preventDefault(),e(".ctc-recent-container").is(":visible")?(e(".ctc-recent-container").stop().slideUp(),e(".ctc-option-panel").css({width:"95%"})):(e(".ctc-recent-container").hasClass("moved")||e(".ctc-recent-container").addClass("moved").detach().appendTo("#ctc_option_panel_wrapper"),e(".ctc-recent-container").stop().slideDown(),e(".ctc-option-panel").css({width:"80%"})),!1}),e("#ctc_is_debug").on("change",function(){O(this)}),e(".ctc-live-preview").on("click",function(t){return t.stopImmediatePropagation(),t.preventDefault(),document.location=e(this).prop("href"),!1}),v(),P(et),E(),k(),e("input[type=submit], input[type=button]").prop("disabled",!1),setTimeout(o,15e3)):G()});
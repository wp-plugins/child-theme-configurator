jQuery(document).ready(function(e){function t(e){return v(e)?e:e.toString().replace(K,"&quot;")}function c(e){var t=parseInt(e),c=String.fromCharCode(t);return c}function a(e){var t=e.charCodeAt(0);return t}function l(t,c){var a=!1;return e.each(ctcAjax.themes,function(l,n){return e.each(n,function(e){return e!=t||"parnt"!=l&&"new"!=c?void 0:(a=!0,!1)}),a?!1:void 0}),a}function n(){var t=/[^\w\-]/,c=e("#ctc_child_template").val().toString().replace(t).toLowerCase(),a=e("#ctc_theme_child").val().toString().replace(t).toLowerCase(),n=e("input[name=ctc_child_type]:checked").val(),r=[];return"new"==n&&(a=c),l(a,n)&&r.push(ctcAjax.theme_exists_txt.toString().replace(/%s/,a)),""===a&&r.push(ctcAjax.inval_theme_txt),""===e("#ctc_child_name").val()&&r.push(ctcAjax.inval_name_txt),r.length?($({error:r}),!1):!0}function r(){if(e("#ctc_theme_parnt").length){for(var t=e("#ctc_theme_parnt").val(),c=slugbase=t+"-child",a=ctcAjax.themes.parnt[t].Name+" Child",n="",r="",i="00";l(c,"new");)n=""==n?2:n+1,r=i.substring(0,i.length-n.toString().length)+n.toString(),c=slugbase+r;W=c,X=a+(r.length?" "+r:"")}}function i(t){var c=t+"_panel";e(".nav-tab").removeClass("nav-tab-active"),e(".ctc-option-panel").removeClass("ctc-option-panel-active"),e(".ctc-selector-container").hide(),e(t).addClass("nav-tab-active"),e(".ctc-option-panel-container").scrollTop(0),e(c).addClass("ctc-option-panel-active")}function s(c){var a;e("#ctc_rewrite_selector").length?(a=e("#ctc_rewrite_selector_orig").val(),e("#ctc_sel_ovrd_selector_selected").text(a),e(c).text(ctcAjax.rename_txt)):(a=e("#ctc_sel_ovrd_selector_selected").text(),e("#ctc_sel_ovrd_selector_selected").html('<textarea id="ctc_rewrite_selector" name="ctc_rewrite_selector" autocomplete="off"></textarea><input id="ctc_rewrite_selector_orig" name="ctc_rewrite_selector_orig" type="hidden" value="'+t(a)+'"/>'),e("#ctc_rewrite_selector").val(a),e(c).text(ctcAjax.cancel_txt))}function o(){e(".updated, .error").slideUp("slow",function(){e(".updated").remove()})}function _(t){var c=/^(ctc_(ovrd|\d+)_(parent|child)_([0-9a-z\-]+)_(\d+))(_\w+)?$/,a=e(t).parents(".ctc-selector-row, .ctc-parent-row").first(),l=a.find(".ctc-swatch").first(),n={parent:{},child:{}},r={parent:{origin:"",start:"",end:""},child:{origin:"",start:"",end:""}},i={child:!1,parent:!1},s={};return a.find(".ctc-parent-value, .ctc-child-value").each(function(){var a,l,o=e(this).attr("id"),_=o.toString().match(c),u=_[2],h=_[3],p="undefined"==typeof _[4]?"":_[4],f=_[5],x="undefined"==typeof _[6]?"":_[6],m="parent"==h?e(this).text().replace(/!$/,""):e(this).val(),g="ctc_"+u+"_child_"+p+"_i_"+f;if(!1===v(e(this).data("color"))&&(m=e(this).data("color"),e(this).data("color",null)),"child"==h&&(s[o]=m,s[g]=e("#"+g).is(":checked")?1:0),""!=m)if(!1===v(x))switch(x){case"_border_width":n[h][p+"-width"]="none"==m?0:m;break;case"_border_style":n[h][p+"-style"]=m;break;case"_border_color":n[h][p+"-color"]=m;break;case"_background_url":n[h]["background-image"]=d(h,m);break;case"_background_color":n[h]["background-color"]=t.value;break;case"_background_color1":r[h].start=m,i[h]=!0;break;case"_background_color2":r[h].end=m,i[h]=!0;break;case"_background_origin":r[h].origin=m,i[h]=!0}else(a=p.toString().match(/^border(\-(top|right|bottom|left))?$/)&&!m.match(/none/))?(l=m.toString().split(/ +/),n[h][p+"-width"]="undefined"==typeof l[0]?"":l[0],n[h][p+"-style"]="undefined"==typeof l[1]?"":l[1],n[h][p+"-color"]="undefined"==typeof l[2]?"":l[2]):"background-image"!=p||m.match(/none/)?"seq"!=p&&(n[h][p]=m):m.toString().match(/url\(/)?n[h]["background-image"]=d(h,m):(l=m.toString().split(/ +/),l.length>2?(r[h].origin="undefined"==typeof l[0]?"top":l[0],r[h].start="undefined"==typeof l[1]?"transparent":l[1],r[h].end="undefined"==typeof l[2]?"transparent":l[2],i[h]=!0):n[h]["background-image"]=m)}),"undefined"!=typeof l&&!1===v(l.attr("id"))&&(l.removeAttr("style"),i.parent&&l.ctcgrad(r.parent.origin,[r.parent.start,r.parent.end]),l.css(n.parent),l.attr("id").toString().match(/parent/)||(i.child&&l.ctcgrad(r.child.origin,[r.child.start,r.child.end]),l.css(n.child)),l.css({"z-index":-1})),s}function u(e,t){t="undefined"==typeof t?"":t;var c={orig:t};if(e.toString().match(/^border(\-(top|right|bottom|left))?$/)){var a=t.toString().split(/ +/);c.names=["_border_width","_border_style","_border_color"],c.values=["undefined"==typeof a[0]?"":a[0],"undefined"==typeof a[1]?"":a[1],"undefined"==typeof a[2]?"":a[2]]}else if(e.toString().match(/^background\-image/))if(c.names=["_background_url","_background_origin","_background_color1","_background_color2"],c.values=["","","",""],!1!==v(t)||t.toString().match(/(url|none)/))c.values[0]=t;else{var a=t.toString().split(/:/);c.values[1]="undefined"==typeof a[0]?"":a[0],c.values[2]="undefined"==typeof a[1]?"":a[1],c.values[3]="undefined"==typeof a[3]?"":a[3],c.orig=[c.values[1],c.values[2],c.values[3]].join(" ")}else c.names=[""],c.values=[t];return c}function d(e,t){var c,a=t.toString().match(/url\(['" ]*(.+?)['" ]*\)/),l=v(a)?null:a[1],n=ctcAjax.theme_uri+"/"+("parent"==e?ctcAjax.parnt:ctcAjax.child)+"/";return l?c=l.toString().match(/^(data:|https?:|\/)/)?t:"url("+n+l+")":!1}function v(e){if("undefined"==typeof e||!1===e||null===e||""===e)return!0;if(!0===e||"string"==typeof e||"number"==typeof e)return!1;if("object"==typeof e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}return!1}function h(e){if("object"==typeof ctcAjax.sel_val[e]&&"object"==typeof ctcAjax.sel_val[e].value)for(var t in ctcAjax.sel_val[e].value)if(ctcAjax.sel_val[e].value.hasOwnProperty(t)&&(!1===v(ctcAjax.sel_val[e].value[t].child)||!1===v(ctcAjax.sel_val[e].value[t].parnt)))return e;return delete ctcAjax.sel_val[e],!1}function p(){Z.rld_rule=1,Z.rld_sel=1,f(),m()}function f(){if(1!==Z.sel_ndx){if(0===Z.sel_ndx||1==Z.rld_sel)return Z.sel_ndx=1,Z.rld_sel=0,void P("sel_ndx",null,f);tt=[],!1===v(ctcAjax.sel_ndx)&&e.each(ctcAjax.sel_ndx,function(e){var t={label:e,value:e};tt.push(t)}),C(),x()}}function x(){if(1!==Z.sel_ndx){if(0===Z.sel_ndx)return Z.sel_ndx=1,void P("sel_ndx",Y,x);et=[],!1===v(ctcAjax.sel_ndx)&&e.each(ctcAjax.sel_ndx[Y],function(e,t){var c={label:e,value:t};et.push(c)}),D(),Z.set_sel&&(Z.set_sel=0,E(H,null))}}function m(){if(1!==Z.rule){if(0===Z.rule||1==Z.rld_rule)return Z.rule=1,Z.rld_rule=0,void P("rule",null,m);ct=[],!1===v(ctcAjax.rule)&&e.each(ctcAjax.rule,function(e,t){var a={label:t.replace(/\d+/g,c),value:e};ct.push(a)}),ct=ct.sort(function(e,t){return e.label>t.label?1:e.label<t.label?-1:0}),R(),F()}}function g(e){return 1===Z.sel_val?!1:v(ctcAjax.sel_val[e])?(0==Z.sel_val&&(Z.sel_val=1,P("sel_val",e,g)),!1):(H=e,void(1==Z.set_qry?(Z.set_qry=0,z(ctcAjax.sel_val[e].query)):1==Z.new_sel&&(Z.new_sel=0,w(e))))}function y(t,a){var l=[],n=v(ctcAjax.sel_val[H])||v(ctcAjax.sel_val[H].value);v(ct)&&m(),e.each(ct,function(a,r){var i=!1,s=new RegExp(e.ui.autocomplete.escapeRegex(t.term),"i");if(s.test(r.label)){if(!1===n&&(e.each(ctcAjax.sel_val[H].value,function(e){return r.label==e.replace(/\d+/g,c)?(i=!0,!1):void 0}),i))return;l.push(r)}}),a(l)}function j(a,l,n){var r="",i=v(ctcAjax.sel_val[a])||v(ctcAjax.sel_val[a].value)||v(ctcAjax.sel_val[a].value[l])?"":ctcAjax.sel_val[a].value[l],s=u(l,"undefined"==typeof i?"":i.parnt),o=!1===v(i.i_parnt)&&1==i.i_parnt?ctcAjax.important_label:"",_=u(l,"undefined"==typeof i?"":i.child),d=!1===v(i.i_child)&&1==i.i_child?1:0,h="ctc_"+n+"_child_"+l+"_i_"+a;return!1===v(ctcAjax.sel_val[a])&&(r+='<div class="ctc-'+("ovrd"==n?"input":"selector")+'-row clearfix">'+J,r+='<div class="ctc-input-cell">'+("ovrd"==n?l.replace(/\d+/g,c):ctcAjax.sel_val[a].selector+'<br/><a href="#" class="ctc-selector-edit" id="ctc_selector_edit_'+a+'" >'+ctcAjax.edit_txt+"</a> "+(v(s.orig)?ctcAjax.child_only_txt:""))+"</div>"+J,"ovrd"==n&&(r+='<div class="ctc-parent-value ctc-input-cell" id="ctc_'+n+"_parent_"+l+"_"+a+'">'+(v(s.orig)?"[no value]":s.orig+o)+"</div>"+J),r+='<div class="ctc-input-cell">'+J,!1===v(s.names)&&(e.each(s.names,function(e,c){c=v(c)?"":c,r+='<div class="ctc-child-input-cell">'+J;var i,s="ctc_"+n+"_child_"+l+"_"+a+c;!1===(i=_.values.shift())&&(i=""),r+=(v(c)?"":ctcAjax.field_labels[c]+":<br/>")+'<input type="text" id="'+s+'" name="'+s+'" class="ctc-child-value'+((c+l).toString().match(/color/)?" color-picker":"")+(c.toString().match(/url/)?" ctc-input-wide":"")+'" value="'+t(i)+'" />'+J,r+="</div>"+J}),r+='<label for="'+h+'"><input type="checkbox" id="'+h+'" name="'+h+'" value="1" '+(1===d?"checked":"")+" />"+ctcAjax.important_label+"</label>"+J),r+="</div>"+J,r+="ovrd"==n?"":'<div class="ctc-swatch ctc-specific" id="ctc_child_'+l+"_"+a+'_swatch">'+ctcAjax.swatch_txt+"</div>"+J+'<div class="ctc-child-input-cell ctc-button-cell" id="ctc_save_'+l+"_"+a+'_cell">'+J+'<input type="button" class="button ctc-save-input" id="ctc_save_'+l+"_"+a+'" name="ctc_save_'+l+"_"+a+'" value="Save" /></div>'+J,r+="</div><!-- end input row -->"+J),r}function w(t){var c,a,l;(t=h(t))?(e("#ctc_sel_ovrd_qsid").val(t),H=t,v(ctcAjax.sel_val[t].seq)?e("#ctc_child_load_order_container").html(""):(c="ctc_ovrd_child_seq_"+t,l=parseInt(ctcAjax.sel_val[t].seq),a='<input type="text" id="'+c+'" name="'+c+'" class="ctc-child-value" value="'+l+'" />',e("#ctc_child_load_order_container").html(a)),v(ctcAjax.sel_val[t].value)?e("#ctc_sel_ovrd_rule_inputs").slideUp(function(){e("#ctc_sel_ovrd_rule_inputs").html("")}):(a="",e.each(ctcAjax.sel_val[t].value,function(e){a+=j(t,e,"ovrd")}),e("#ctc_sel_ovrd_rule_inputs").html(a).find(".color-picker").each(function(){S(this)}),_("#ctc_child_all_0_swatch"),e("#ctc_sel_ovrd_selector_selected").text(ctcAjax.sel_val[t].selector),e(".ctc-rewrite-toggle").text(ctcAjax.rename_txt),e("#ctc_sel_ovrd_new_rule, #ctc_sel_ovrd_rule_header, #ctc_sel_ovrd_rule_inputs_container, #ctc_sel_ovrd_rule_inputs, .ctc-rewrite-toggle").slideDown())):(e("#ctc_sel_ovrd_selector_selected").html("&nbsp;"),e("#ctc_sel_ovrd_new_rule, #ctc_sel_ovrd_rule_header, #ctc_sel_ovrd_rule_inputs_container, #ctc_sel_ovrd_rule_inputs, .ctc-rewrite-toggle").slideUp(function(){e("#ctc_sel_ovrd_rule_inputs").html("")})),a=null}function A(t){if(1===Z.preview)return!1;if(0==Z.preview){Z.preview=1;var t;return(t=t.match(/(child|parnt)/)[1])||(t="child"),$(""),P("preview",t,A),!1}e("#view_"+t+"_options_panel").text(ctcAjax.previewResponse),ctcAjax.previewResponse=null,Z.preview=0}function b(t){if(1===Z.rule_val)return!1;if(0==Z.rule_val)return Z.rule_val=1,P("rule_val",t,b),!1;var c=ctcAjax.rule[t],a='<div class="ctc-input-row clearfix" id="ctc_rule_row_'+c+'">'+J;!1===v(ctcAjax.rule_val[t])&&(e.each(ctcAjax.rule_val[t],function(e,t){var l=u(c,t);a+='<div class="ctc-parent-row clearfix" id="ctc_rule_row_'+c+"_"+e+'">'+J,a+='<div class="ctc-input-cell ctc-parent-value" id="ctc_'+e+"_parent_"+c+"_"+e+'">'+l.orig+"</div>"+J,a+='<div class="ctc-input-cell">'+J,a+='<div class="ctc-swatch ctc-specific" id="ctc_'+e+"_parent_"+c+"_"+e+'_swatch">'+ctcAjax.swatch_txt+"</div></div>"+J,a+='<div class="ctc-input-cell"><a href="#" class="ctc-selector-handle" id="ctc_selector_'+c+"_"+e+'">'+ctcAjax.selector_txt+"</a></div>"+J,a+='<div id="ctc_selector_'+c+"_"+e+'_container" class="ctc-selector-container">'+J,a+='<a href="#" id="ctc_selector_'+c+"_"+e+'_close" class="ctc-selector-handle ctc-exit" title="'+ctcAjax.close_txt+'"></a>',a+='<div id="ctc_selector_'+c+"_"+e+'_inner_container" class="ctc-selector-inner-container clearfix">'+J,a+='<div id="ctc_status_val_qry_'+e+'"></div>'+J,a+='<div id="ctc_selector_'+c+"_"+e+'_rows"></div>'+J,a+="</div></div></div>"+J}),a+="</div>"+J),e("#ctc_rule_value_inputs").html(a).find(".ctc-swatch").each(function(){_(this)}),a=null}function k(){var t="";v(ctcAjax.recent)?t+=ctcAjax.recent_txt:(t+="<ul>\n",e.each(ctcAjax.recent,function(c,a){e.each(a,function(e,c){t+='<li><a href="#" class="ctc-selector-edit" id="ctc_selector_edit_'+e+'" >'+c+"</a></li>\n"})}),t+="</ul>\n"),e("#ctc_recent_selectors").html(t),t=null}function q(t){if(1==Z.val_qry)return!1;var c,l,n=e("#ctc_rule_menu_selected").text().replace(/[^\w\-]/g,a),r="";return 0===Z.val_qry?(Z.val_qry=1,c={rule:n},P("val_qry",t,q,c),!1):(!1===v(ctcAjax.val_qry[t])&&e.each(ctcAjax.val_qry[t],function(c,a){page_rule=c,e.each(a,function(a,l){r+='<h4 class="ctc-query-heading">'+a+"</h4>"+J,!1===v(l)&&e.each(l,function(e,a){ctcAjax.sel_val[e]=a,r+=j(e,c,t)})})}),l="#ctc_selector_"+n+"_"+t+"_rows",e(l).html(r).find(".color-picker").each(function(){S(this)}),void e(l).find(".ctc-swatch").each(function(){_(this)}))}function S(t){e(t).iris({change:function(c,a){e(t).data("color",a.color.toString()),_(t)}})}function C(){e("#ctc_sel_ovrd_query").autocomplete({source:tt,minLength:0,selectFirst:!0,autoFocus:!0,select:function(e,t){return z(t.item.value),!1},focus:function(e){e.preventDefault()}})}function D(){e("#ctc_sel_ovrd_selector").autocomplete({source:et,selectFirst:!0,autoFocus:!0,select:function(e,t){return E(t.item.value,t.item.label),!1},focus:function(e){e.preventDefault()}})}function R(){e("#ctc_rule_menu").autocomplete({source:ct,selectFirst:!0,autoFocus:!0,select:function(e,t){return L(t.item.value,t.item.label),!1},focus:function(e){e.preventDefault()}})}function F(){e("#ctc_new_rule_menu").autocomplete({source:y,selectFirst:!0,autoFocus:!0,select:function(t,c){t.preventDefault();var l=e(j(H,c.item.label.replace(/[^\w\-]/g,a),"ovrd"));return e("#ctc_sel_ovrd_rule_inputs").append(l),e("#ctc_new_rule_menu").val(""),v(ctcAjax.sel_val[H].value)&&(ctcAjax.sel_val[H].value={}),ctcAjax.sel_val[H].value[c.item.label]={child:""},l.find('input[type="text"]').each(function(t,c){e(c).hasClass("color-picker")&&S(c),e(c).focus()}),!1},focus:function(e){e.preventDefault()}})}function T(){if(e("#ctc_theme_child").length&&e("#ctc_child_type_existing").is(":checked")){var t=e("#ctc_theme_child").val();!1===v(t)&&(e("#ctc_child_name").val(ctcAjax.themes.child[t].Name),e("#ctc_child_author").val(ctcAjax.themes.child[t].Author),e("#ctc_child_version").val(ctcAjax.themes.child[t].Version))}}function $(t){var c="";!1===v(t)&&e.each(t,function(t,a){c+='<div class="'+t+'"><ul>'+J,e(a).each(function(e,t){c+="<li>"+t.toString()+"</li>"+J}),c+="</ul></div>"}),e("#ctc_error_notice").html(c)}function M(t){e("#ctc_theme_parent").parents(".ctc-input-row").first().append('<span class="ctc-status-icon spinner"></span>'),e(".spinner").show(),document.location="?page="+ctcAjax.page+"&ctc_parent="+t.value}function I(t){!1===v(ctcAjax.themes.child[t.value])&&(e("#ctc_child_name").val(ctcAjax.themes.child[t.value].Name),e("#ctc_child_author").val(ctcAjax.themes.child[t.value].Author),e("#ctc_child_version").val(ctcAjax.themes.child[t.value].Version))}function z(t){Y=t,e("#ctc_sel_ovrd_query").val(""),e("#ctc_sel_ovrd_query_selected").text(t),e("#ctc_sel_ovrd_selector").val(""),e("#ctc_sel_ovrd_selector_selected").html("&nbsp;"),e("#ctc_sel_ovrd_rule_inputs").html(""),x()}function E(t){e("#ctc_sel_ovrd_selector").val(""),1!=Z.sel_val&&(Z.sel_val=0),H=t,Z.new_sel=1,g(t)}function L(t,c){e("#ctc_rule_menu").val(""),e("#ctc_rule_menu_selected").text(c),1!=Z.rule_val&&(Z.rule_val=0),b(t),e(".ctc-rewrite-toggle").text(ctcAjax.rename_txt),e("#ctc_rule_value_inputs, #ctc_input_row_rule_header").show()}function N(t){var c=e(t).attr("id").match(/_(\d+)$/)[1];i("#query_selector_options"),Z.sel_val=0,Z.set_sel=Z.set_qry=1,H=c,g(c)}function O(){var t,c=e("#ctc_theme_parnt").val(),a=ctcAjax.theme_uri.replace(/^https?:\/\//,""),l=ctcAjax.homeurl.replace(/^https?/,ctcAjax.ssl?"https":"http"),n=l+"?preview=1&p=x&template="+c+"&stylesheet="+c,r=new RegExp("<link rel=[\"']stylesheet[\"'][^>]+?"+a+"/"+c+"/(.+?\\.css)[^>]+?>","g");v(c)||(c!=ctcAjax.parnt?e.get(n,function(c){for(;(t=r.exec(c))&&"style.css"!=t[1];)t[1].match(/bootstrap/)||e(".ctc_checkbox").each(function(){e(this).val()==t[1]&&e(this).prop("checked",!0)});c=null}):e(ctcAjax.addl_css).each(function(t,c){e("#ctc_stylesheet_files .ctc_checkbox").each(function(){e(this).val()==c&&e(this).prop("checked",!0)})}))}function P(t,c,a,l){var n={ctc_query_obj:t,ctc_query_key:c},r="#ctc_status_"+t+("val_qry"==t?"_"+c:"");return"object"==typeof l&&e.each(l,function(e,t){n["ctc_query_"+e]=t}),e(".query-icon").remove(),e(r).append('<span class="ctc-status-icon spinner query-icon"></span>'),e(".spinner").show(),n.action=!1===v(e("#ctc_action").val())&&"plugin"==e("#ctc_action").val()?"ctc_plgqry":"ctc_query",n._wpnonce=e("#_wpnonce").val(),e.post(ctcAjax.ajaxurl,n,function(l){Z[t]=2,v(l)?(e(".query-icon").addClass("failure"),"preview"==t&&(ctcAjax.previewResponse=ctcAjax.css_fail_txt,a(c))):(e(".ctc-status-icon").addClass("success"),1==Z.refresh&&(Z.refresh=0,Q()),V(l),l=null,k(),"function"==typeof a&&a(c))},"json").fail(function(){e(".query-icon").removeClass("spinner"),e(".query-icon").addClass("failure"),"preview"==t?(ctcAjax.previewResponse=ctcAjax.css_fail_txt,Z[t]=2,a(c)):Z[t]=0}),!1}function U(t,c){var a,l,n,r,i={},s=e(t).attr("id");return e(t).prop("disabled",!0),e(".save-icon").remove(),e(t).parent(".ctc-textarea-button-cell, .ctc-button-cell").append('<span class="ctc-status-icon spinner save-icon"></span>'),s.match(/ctc_configtype/)?(e(t).parents(".ctc-input-row").first().append('<span class="ctc-status-icon spinner save-icon"></span>'),i.ctc_configtype=e(t).val()):(a=e("#ctc_new_selectors"))&&"ctc_save_new_selectors"==e(t).attr("id")?(i.ctc_new_selectors=a.val(),(l=e("#ctc_sel_ovrd_query_selected"))&&(i.ctc_sel_ovrd_query=l.text())):(n=e("#ctc_child_imports"))&&"ctc_save_imports"==e(t).attr("id")?i.ctc_child_imports=n.val():i=_(t),e(".save-icon").show(),e("#ctc_sel_ovrd_selector_selected").find("#ctc_rewrite_selector").each(function(){r=e("#ctc_rewrite_selector").val(),origsel=e("#ctc_rewrite_selector_orig").val(),v(r)||!r.toString().match(/\w/)?r=origsel:i.ctc_rewrite_selector=r,e(".ctc-rewrite-toggle").text(ctcAjax.rename_txt),e("#ctc_sel_ovrd_selector_selected").html(r)}),i.action=!1===v(e("#ctc_action").val())&&"plugin"==e("#ctc_action").val()?"ctc_plugin":"ctc_update",i._wpnonce=e("#_wpnonce").val(),e.post(ctcAjax.ajaxurl,i,function(a){return e(t).prop("disabled",!1),e(".save-icon").removeClass("spinner"),v(a)?e(".save-icon").addClass("failure"):(e("#ctc_new_selectors").val(""),1==Z.refresh&&(Z.refresh=0,Q()),V(a),a=null,v(B)?H&&(w(H),k()):(E(B,G),B=G=null),e(".save-icon").addClass("success"),"function"==typeof c&&c()),!1},"json").fail(function(){e(t).prop("disabled",!1),e(".save-icon").removeClass("spinner"),e(".save-icon").addClass("failure")}),!1}function V(t){e(t).each(function(){switch(this.obj){case"imports":ctcAjax.imports=this.data;break;case"rule_val":ctcAjax.rule_val[this.key]=this.data;break;case"val_qry":ctcAjax.val_qry[this.key]=this.data;break;case"rule":ctcAjax.rule=this.data;break;case"sel_ndx":v(this.key)?ctcAjax.sel_ndx=this.data:"qsid"==this.key?(v(ctcAjax.sel_ndx[this.data.query])&&(ctcAjax.sel_ndx[this.data.query]={}),ctcAjax.sel_ndx[this.data.query][this.data.selector]=this.data.qsid):(ctcAjax.sel_ndx[this.key]=this.data,Y=this.key);break;case"sel_val":ctcAjax.sel_val[this.key]=this.data,H=this.key;break;case"rewrite":H=this.key,B=this.key,G=this.data;break;case"recent":ctcAjax.recent=this.data;break;case"stylesheets":e("#ctc_stylesheet_files").html(this.data);break;case"backups":e("#ctc_backup_files").html(this.data);break;case"addl_css":ctcAjax.addl_css=this.data;break;case"preview":case"all_styles":ctcAjax.previewResponse=this.data}}),t=null}function Q(){Y="base",H=null,et=[],tt=[],ct=[],Z.rld_rule=1,Z.rld_sel=1,Z.set_qry=1,ctcAjax.imports=[],ctcAjax.recent={},ctcAjax.rule={},ctcAjax.sel_ndx={},ctcAjax.val_qry={},ctcAjax.rule_val={},ctcAjax.sel_val={},p()}var B,G,H,J="\n",K=new RegExp('"',"g"),W="",X="",Y="base",Z={rule:0,sel_ndx:0,val_qry:0,rule_val:0,sel_val:0,preview:0,recent:0,rld_rule:0,rld_sel:0,set_qry:0,set_sel:0,new_sel:0,refresh:0},et=[],tt=[],ct=[];r(),T(),e("#ctc_theme_parnt").is("input")||(e.widget("ctc.themeMenu",e.ui.selectmenu,{_renderItem:function(t,c){var a=e("<li>");return e("#ctc_theme_option_"+c.value).detach().appendTo(a),a.appendTo(t)}}),e("#ctc_theme_parnt").themeMenu({select:function(e,t){M(t.item)}}),v(ctcAjax.themes.child)?(e("#ctc_child_name").val(X),e("#ctc_child_template").val(W)):e("#ctc_theme_child").themeMenu({select:function(e,t){I(t.item)}})),e("#ctc_main").on("focus",".color-picker",function(){$(""),e(".color-picker").not(this).iris("hide"),e(this).iris("toggle"),e(".iris-picker").css({position:"absolute","z-index":10})}),e("#ctc_main").on("change",".ctc-child-value, input[type=checkbox]",function(){_(this)}),e("#ctc_main").on("click",".ctc-selector-handle",function(t){t.preventDefault(),$("");var c=e(this).attr("id").toString().replace("_close",""),a=c.toString().match(/_(\d+)$/)[1];e("#"+c+"_container").is(":hidden")&&(1!=Z.val_qry&&(Z.val_qry=0),q(a)),e("#"+c+"_container").fadeToggle("fast"),e(".ctc-selector-container").not("#"+c+"_container").fadeOut("fast")}),e("#ctc_main").on("click",".nav-tab",function(t){t.preventDefault(),$(""),e(".ctc-status-icon").remove();var c="#"+e(this).attr("id");i(c)}),e("#ctc_main").on("click",".ctc-save-input",function(){U(this,p)}),e("#ctc_main").on("click",".ctc-selector-edit",function(){N(this)}),e("#ctc_main").on("click",".ctc-rewrite-toggle",function(e){e.preventDefault(),s(this)}),e("#ctc_main").on("click",".ctc-section-toggle",function(){e(this).toggleClass("open");var t=e(this).attr("id")+"_content";e("#"+t).slideToggle("fast")}),e("#ctc_main").on("click","#ctc_copy_selector",function(){var t=e("#ctc_sel_ovrd_selector_selected").text().trim();!1===v(t)&&e("#ctc_new_selectors").val(e("#ctc_new_selectors").val()+"\n"+t+" {\n\n}")}),e("#ctc_configtype").on("change",function(){var t=e(this).val();v(t)||"theme"==t?(e(".ctc-theme-only, .ctc-themeonly-container").removeClass("ctc-disabled"),e(".ctc-theme-only, .ctc-themeonly-container input").prop("disabled",!1),e("#ctc_theme_parnt, #ctc_theme_child").themeMenu("enable")):(e(".ctc-theme-only, .ctc-themeonly-container").addClass("ctc-disabled"),e(".ctc-theme-only, .ctc-themeonly-container input").prop("disabled",!0),e("#ctc_theme_parnt, #ctc_theme_child").themeMenu("disable"))}),e("#view_child_options, #view_parnt_options").on("click",function(){A(e(this).attr("id"))}),e("#ctc_load_form").on("submit",function(){return n()&&confirm(ctcAjax.load_txt)}),e("#ctc_theme_child, #ctc_theme_child-button, #ctc_child_type_existing").on("focus click",function(){e("#ctc_child_type_existing").prop("checked",!0),e("#ctc_child_type_new").prop("checked",!1),e("#ctc_child_template").val(""),T()}),e("#ctc_child_type_new, #ctc_child_template").on("focus click",function(){e("#ctc_child_type_existing").prop("checked",!1),e("#ctc_child_type_new").prop("checked",!0),e("#ctc_child_name").val(X),e("#ctc_child_template").val(W)}),e("#recent_edits").on("click",function(t){return t.preventDefault(),e(".wrap").css({overflow:"hidden"}),e(".ctc-recent-container").is(":visible")?(e(this).removeClass("open"),e(".ctc-recent-container").stop().animate({right:-200},function(){e(this).hide()}),e(".ctc-option-panel").css({width:"95%"})):(e(this).addClass("open"),e(".ctc-recent-container").stop().css({right:-200}).show().animate({right:0}),e(".ctc-option-panel").css({width:"80%"})),e(".wrap").css({overflow:"inherit"}),!1}),e(".ctc-live-preview").on("click",function(t){return t.stopImmediatePropagation(),t.preventDefault(),document.location=e(this).prop("href"),!1}),p(),z(Y),O(),k(),e("input[type=submit], input[type=button]").prop("disabled",!1),setTimeout(o,15e3)});
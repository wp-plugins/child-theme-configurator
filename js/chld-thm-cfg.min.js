!function(e){e.chldthmcfg=function(){function t(e){return l(e)?e:e.toString().replace(S,"&quot;")}function c(e){return(text=ctcAjax[e+"_txt"])?text:""}function n(e){var t=parseInt(e),c=String.fromCharCode(t);return c}function i(t){console.log("coalesce_inputs "+e(t).attr("id"));var c=/^(ctc_(ovrd|\d+)_(parent|child)_([0-9a-z\-]+)_(\d+))(_\w+)?$/,n=e(t).parents(".ctc-selector-row, .ctc-parent-row").first(),i=n.find(".ctc-swatch").first(),r={parent:{},child:{}},a={parent:{origin:"",start:"",end:""},child:{origin:"",start:"",end:""}},s={child:!1,parent:!1},d={};return n.find(".ctc-parent-value, .ctc-child-value").each(function(){var n,i,u=e(this).attr("id"),_=u.toString().match(c),p=_[2],h=_[3],v="undefined"==typeof _[4]?"":_[4],f=_[5],g="undefined"==typeof _[6]?"":_[6],m="parent"==h?e(this).text().replace(/!$/,""):e(this).val(),y="ctc_"+p+"_child_"+v+"_i_"+f;if(l(e(this).data("color"))||(m=e(this).data("color"),e(this).data("color",null)),"child"==h&&(d[u]=m,d[y]=e("#"+y).is(":checked")?1:0),""!=m)if(l(g))(n=v.toString().match(/^border(\-(top|right|bottom|left))?$/)&&!m.match(/none/))?(i=m.toString().split(/ +/),r[h][v+"-width"]="undefined"==typeof i[0]?"":i[0],r[h][v+"-style"]="undefined"==typeof i[1]?"":i[1],r[h][v+"-color"]="undefined"==typeof i[2]?"":i[2]):"background-image"!=v||m.match(/none/)?"seq"!=v&&(r[h][v]=m):m.toString().match(/url\(/)?r[h]["background-image"]=o(h,m):(i=m.toString().split(/ +/),i.length>2?(a[h].origin="undefined"==typeof i[0]?"top":i[0],a[h].start="undefined"==typeof i[1]?"transparent":i[1],a[h].end="undefined"==typeof i[2]?"transparent":i[2],s[h]=!0):r[h]["background-image"]=m);else switch(g){case"_border_width":r[h][v+"-width"]="none"==m?0:m;break;case"_border_style":r[h][v+"-style"]=m;break;case"_border_color":r[h][v+"-color"]=m;break;case"_background_url":r[h]["background-image"]=o(h,m);break;case"_background_color":r[h]["background-color"]=t.value;break;case"_background_color1":a[h].start=m,s[h]=!0;break;case"_background_color2":a[h].end=m,s[h]=!0;break;case"_background_origin":a[h].origin=m,s[h]=!0}}),"undefined"==typeof i||l(i.attr("id"))||(i.removeAttr("style"),s.parent&&i.ctcgrad(a.parent.origin,[a.parent.start,a.parent.end]),i.css(r.parent),i.attr("id").toString().match(/parent/)||(s.child&&i.ctcgrad(a.child.origin,[a.child.start,a.child.end]),i.css(r.child)),i.css({"z-index":-1})),d}function r(e,t){t="undefined"==typeof t?"":t;var c={orig:t};if(e.toString().match(/^border(\-(top|right|bottom|left))?$/)){var n=t.toString().split(/ +/);c.names=["_border_width","_border_style","_border_color"],c.values=["undefined"==typeof n[0]?"":n[0],"undefined"==typeof n[1]?"":n[1],"undefined"==typeof n[2]?"":n[2]]}else if(e.toString().match(/^background\-image/))if(c.names=["_background_url","_background_origin","_background_color1","_background_color2"],c.values=["","","",""],!1!==l(t)||t.toString().match(/(url|none)/))c.values[0]=t;else{var n=t.toString().split(/:/);c.values[1]="undefined"==typeof n[0]?"":n[0],c.values[2]="undefined"==typeof n[1]?"":n[1],c.values[3]="undefined"==typeof n[3]?"":n[3],c.orig=[c.values[1],c.values[2],c.values[3]].join(" ")}else c.names=[""],c.values=[t];return c}function o(e,t){var c,n=t.toString().match(/url\(['" ]*(.+?)['" ]*\)/),i=l(n)?null:n[1],r=ctcAjax.theme_uri+"/"+("parent"==e?ctcAjax.parnt:ctcAjax.child)+"/";return i?c=i.toString().match(/^(data:|https?:|\/)/)?t:"url("+r+i+")":!1}function l(e){if("undefined"==typeof e||!1===e||null===e||""===e)return!0;if(!0===e||"string"==typeof e||"number"==typeof e)return!1;if("object"==typeof e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}return!1}function a(){console.log("load_selectors"),y("selectors",A)}function s(){console.log("load_rules"),y("rules",null)}function d(i,o,a,s){console.log("render_child_rule_input: "+i+" rule: "+o+" seq: "+a);var d="",u=l(s)||l(s.value)||l(s.value[o])?"":s.value[o],_=r(o,l(u)?"":u.parnt),p=l(u)||l(u.i_parnt)||1!=u.i_parnt?"":c("important"),h=r(o,l(u)?"":u.child),v=l(u)||l(u.i_child)||1!=u.i_child?0:1,f="ctc_"+a+"_child_"+o+"_i_"+i;return l(s)||(d+='<div class="ctc-'+("ovrd"==a?"input":"selector")+'-row clearfix">'+j+'<div class="ctc-input-cell">'+("ovrd"==a?o.replace(/\d+/g,n):s.selector+'<br/><a href="#" class="ctc-selector-edit" id="ctc_selector_edit_'+i+'" >'+c("edit")+"</a> "+(l(_.orig)?c("child_only"):""))+"</div>"+j,"ovrd"==a&&(d+='<div class="ctc-parent-value ctc-input-cell" id="ctc_'+a+"_parent_"+o+"_"+i+'">'+(l(_.orig)?"[no value]":_.orig+p)+"</div>"+j),d+='<div class="ctc-input-cell">'+j,l(_.names)||(e.each(_.names,function(e,c){c=l(c)?"":c,d+='<div class="ctc-child-input-cell">'+j;var n,r="ctc_"+a+"_child_"+o+"_"+i+c;!1===(n=h.values.shift())&&(n=""),d+=(l(c)?"":ctcAjax.field_labels[c]+":<br/>")+'<input type="text" id="'+r+'" name="'+r+'" class="ctc-child-value'+((c+o).toString().match(/color/)?" color-picker":"")+(c.toString().match(/url/)?" ctc-input-wide":"")+'" value="'+t(n)+'" />'+j+"</div>"+j}),d+='<label for="'+f+'"><input type="checkbox" id="'+f+'" name="'+f+'" value="1" '+(1===v?"checked":"")+" />"+c("important")+"</label>"+j),d+="</div>"+j+("ovrd"==a?"":'<div class="ctc-swatch ctc-specific" id="ctc_child_'+o+"_"+i+'_swatch">'+c("swatch")+"</div>"+j+'<div class="ctc-child-input-cell ctc-button-cell" id="ctc_save_'+o+"_"+i+'_cell">'+j+'<input type="button" class="button ctc-save-input" id="ctc_save_'+o+"_"+i+'" name="ctc_save_'+o+"_"+i+'" value="Save" /></div>'+j)+"</div><!-- end input row -->"+j),d}function u(){console.log("render_selector_inputs: "+o);var t,n,r,o=N,a=T;e("#ctc_sel_ovrd_qsid").val(o),N=o,l(a.seq)?e("#ctc_child_load_order_container").empty():(t="ctc_ovrd_child_seq_"+o,r=parseInt(a.seq),n='<input type="text" id="'+t+'" name="'+t+'" class="ctc-child-value" value="'+r+'" />',e("#ctc_child_load_order_container").html(n)),l(a.value)?(e("#ctc_sel_ovrd_selector_selected").empty(),e(".ctc-rewrite-toggle").empty(),e("#ctc_sel_ovrd_new_rule,#ctc_sel_ovrd_rule_header,#ctc_sel_ovrd_rule_inputs_container,#ctc_sel_ovrd_rule_inputs,.ctc-rewrite-toggle").hide(),e("#ctc_sel_ovrd_rule_inputs").empty()):(n="",e.each(a.value,function(e){n+=d(o,e,"ovrd",a)}),e("#ctc_sel_ovrd_rule_inputs").html(n).find(".color-picker").each(function(){f(this)}),i("#ctc_child_all_0_swatch"),P.length?q():(console.log("reload menus: "+(C?"true":"false")),C&&(m(a.query),s()),e("#ctc_sel_ovrd_selector_selected").text(a.selector),e(".ctc-rewrite-toggle").text(c("rename")),e("#ctc_sel_ovrd_new_rule,#ctc_sel_ovrd_rule_header,#ctc_sel_ovrd_rule_inputs_container,#ctc_sel_ovrd_rule_inputs,.ctc-rewrite-toggle").show(),_()))}function _(){e(".ctc-option-panel-container").animate({scrollTop:0})}function p(t,n){console.log("render_rule_value_inputs: "+t),console.log(n);var o=I[t],a='<div class="ctc-input-row clearfix" id="ctc_rule_row_'+o+'">'+j;console.log("rule: "+o),l(n)||(e.each(n,function(e,t){var n=r(o,t);a+='<div class="ctc-parent-row clearfix" id="ctc_rule_row_'+o+"_"+e+'">'+j+'<div class="ctc-input-cell ctc-parent-value" id="ctc_'+e+"_parent_"+o+"_"+e+'">'+n.orig+"</div>"+j+'<div class="ctc-input-cell">'+j+'<div class="ctc-swatch ctc-specific" id="ctc_'+e+"_parent_"+o+"_"+e+'_swatch">'+c("swatch")+"</div></div>"+j+'<div class="ctc-input-cell"><a href="#" class="ctc-selector-handle" id="ctc_selector_'+o+"_"+e+'">'+c("selector")+"</a></div>"+j+'<div id="ctc_selector_'+o+"_"+e+'_container" class="ctc-selector-container">'+j+'<a href="#" id="ctc_selector_'+o+"_"+e+'_close" class="ctc-selector-handle ctc-exit" title="'+c("close")+'"></a><div id="ctc_selector_'+o+"_"+e+'_inner_container" class="ctc-selector-inner-container clearfix">'+j+'<div id="ctc_status_val_qry_'+e+'"></div>'+j+'<div id="ctc_selector_'+o+"_"+e+'_rows"></div>'+j+"</div></div></div>"+j}),a+="</div>"+j),e("#ctc_rule_value_inputs").html(a).find(".ctc-swatch").each(function(){i(this)})}function h(t){console.log("render_recent");var n="";if(l(t)&&!l(c("recent")))n+=c("recent");else{if(l(t))return;n+="<ul>"+j,e.each(t,function(t,c){e.each(c,function(e,t){n+='<li><a href="#" class="ctc-selector-edit" id="ctc_selector_edit_'+e+'" >'+t+"</a></li>"+j})}),n+="</ul>"+j}e("#ctc_recent_selectors").html(n)}function v(t,c){console.log("render_selector_value_inputs: "+t);var n="";l(c)||e.each(c,function(c,i){page_rule=c,e.each(i,function(i,r){n+='<h4 class="ctc-query-heading">'+i+"</h4>"+j,l(r)||e.each(r,function(e,i){n+=d(e,c,t,i)})})}),selector="#ctc_selector_"+rule+"_"+t+"_rows",e(selector).html(n).find(".color-picker").each(function(){f(this)}),e(selector).find(".ctc-swatch").each(function(){i(this)}),P.length&&q()}function f(t){try{e(t).iris({change:function(c,n){e(t).data("color",n.color.toString()),i(t)}})}catch(c){x(c,"Iris Color Picker")}}function g(t){var c="";l(t)||e.each(t,function(t,n){c+='<div class="'+t+'"><ul>'+j,e(n).each(function(e,t){c+="<li>"+t.toString()+"</li>"+j}),c+="</ul></div>"}),e("#ctc_error_notice").html(c),e("html, body").animate({scrollTop:0},"slow")}function m(t){console.log("set_query: "+t),A=t,e("#ctc_sel_ovrd_query").val(""),e("#ctc_sel_ovrd_query_selected").text(t),e("#ctc_sel_ovrd_selector").val(""),e("#ctc_sel_ovrd_selector_selected").html("&nbsp;"),a()}function y(t,c,n){console.log("query_css: "+t+" key: "+c);var i={ctc_query_obj:t,ctc_query_key:c},r="#ctc_status_"+t+("val_qry"==t?"_"+c:"");"object"==typeof n&&e.each(n,function(e,t){i["ctc_query_"+e]=t}),e(".query-icon").remove(),e(r).append('<span class="ctc-status-icon spinner query-icon"></span>'),e(".spinner").show(),i.action=l(e("#ctc_action").val())||"plugin"!=e("#ctc_action").val()?"ctc_query":"ctc_plgqry",i._wpnonce=e("#_wpnonce").val(),b(t,i)}function b(t,c){console.log("ajax_post: "+t),console.log(c);var n=ctcAjax.ajaxurl;e.ajax({url:n,data:c,dataType:"json",type:"POST"}).done(function(e){k(t,e)}).fail(function(){w(t)})}function w(t){console.log("handle_failure: "+t),e(".query-icon, .save-icon").removeClass("spinner"),e(".query-icon").addClass("failure"),e(".save-icon").addClass("failure"),e("input[type=submit], input[type=button]").prop("disabled",!1),e(".ajax-pending").removeClass("ajax-pending"),"preview"==t&&e("#view_parnt_options_panel,#view_child_options_panel").text(c("css_fail"))}function k(t,c){console.log("handle_success: "+t),console.log(c),e(".query-icon, .save-icon").removeClass("spinner"),e(".ajax-pending").removeClass("ajax-pending"),l(c)?w(t):(e("#ctc_new_selectors").val(""),e(".ctc-status-icon").addClass("success"),e(".save-icon").addClass("success"),e("input[type=submit], input[type=button]").prop("disabled",!1),e(c).each(function(){console.log("executing method update_ui."+this.obj),"function"==typeof O.update_ui[this.obj]&&O.update_ui[this.obj].call(this)}))}function x(e,t){var c=l(e.lineNumber)?"":" line: "+e.lineNumber,n=l(e.fileName)?"":" "+e.fileName.split(/\?/)[0];P.push("<code><small>"+t+": "+e.message+n+c+"</small></code>")}function q(){var t=[],n=[];e("input[type=submit], input[type=button]").prop("disabled",!0),e("script").each(function(){var c=e(this).prop("src");l(c)||!c.match(/jquery(\.min|\.js|\-?ui)/i)||c.match(/load\-scripts.php/)||t.push("<code><small>"+c.split(/\?/)[0]+"</small></code>")}),n.push("<strong>"+c("js")+"</strong>"),1==ctcAjax.is_debug&&n.push(P.join("<br/>")),t.length&&n.push(c("jquery")+"<br/>"+t.join("<br/>")),n.push(c("plugin")+" "+c("contact")),g({error:n})}console.log("initializing ctc vars");var j="\n",S=new RegExp('"',"g"),C=!1,A="base",N=null,T={},$={},z={},I={},P=[],O={};O={update_ui:{qsid:function(){N=this.key,T=this.data,u()},rule_val:function(){p(this.key,this.data)},val_qry:function(){v(this.key,this.data)},queries:function(){z=this.data},selectors:function(){$=this.data},rules:function(){I=this.data},recent:function(){h(this.data)},debug:function(){e("#ctc_debug_container").html(this.data)},preview:function(){e("#view_"+this.key+"_options_panel").text(this.data)}}}},init(),new e.chldthmcfg}(jQuery);